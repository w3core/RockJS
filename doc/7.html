<h2 id="/doc/7">Module</h2><p>What is the module? Module is a component. In other words, a part or element of a larger whole and logically allocated part of the page.</p><p>For the RockJS, component is a class that has independent DOM model and working by using declaration of special public properties and methods.</p><p>Every instance of component will be created by passing of two arguments:</p><ul><li><p><code>$R</code> - an instance of application that created by RockJS. This is an object that contains a many of global features within an anonymous environment (such as configuration, pages helper, modules helper, tools, and many many more);</p></li><li><p><code>$O</code> - an instance of environment for the component, that contains references to the DOM model, used by component DOM nodes (for the case when the component has defined <code>this.node</code> property), instance of spinner, templating helpers, etc.</p></li></ul><p>Usually, most of your modules will contain UI components. To define UI of module you can use the following properties:</p><ul><li><p><code>{String | Boolean} this.html</code>- this property allows to define HTML markup of module.</p></li><li><p><code>{String | Boolean} this.css</code> - this property allows to define CSS stylesheets of module.</p></li><li><p><code>{String | Object} this.node</code> - this property helps you to select DOM nodes to the <code>$O.node</code> object for working with them.</p></li></ul><p>A <code>this.html</code> and <code>this.css</code> properties can be defined by the following ways:</p><ul><li><p>As inline string. So, you can put as string some HTML strings or CSS properties;</p></li><li><p>As Embedded content (more preffered way) by using special embedding tag <code>include</code> that provided by RockJS (see <a href="#/doc/13">here</a>).</p><p><em>For example:</em></p><pre class="editor-colors lang-javascript"><div class="line"><span class="syntax--source syntax--js"><span class="syntax--variable syntax--language syntax--js"><span>this</span></span><span class="syntax--meta syntax--delimiter syntax--property syntax--period syntax--js"><span>.</span></span><span class="syntax--variable syntax--other syntax--property syntax--js"><span>html</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--js"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--class syntax--js"><span>String</span></span><span class="syntax--meta syntax--brace syntax--round syntax--js"><span>(</span></span><span class="syntax--comment syntax--block syntax--js"><span class="syntax--punctuation syntax--definition syntax--comment syntax--js"><span>/*</span></span><span>[include&nbsp;src=&quot;index.html&quot;&nbsp;format=&quot;STRING&quot;]</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--js"><span>*/</span></span></span><span class="syntax--meta syntax--brace syntax--round syntax--js"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--js"><span>;</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span class="syntax--variable syntax--language syntax--js"><span>this</span></span><span class="syntax--meta syntax--delimiter syntax--property syntax--period syntax--js"><span>.</span></span><span class="syntax--variable syntax--other syntax--property syntax--js"><span>css</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--js"><span>=</span></span><span>&nbsp;</span><span class="syntax--support syntax--class syntax--js"><span>String</span></span><span class="syntax--meta syntax--brace syntax--round syntax--js"><span>(</span></span><span class="syntax--comment syntax--block syntax--js"><span class="syntax--punctuation syntax--definition syntax--comment syntax--js"><span>/*</span></span><span>[include&nbsp;src=&quot;style.css&quot;&nbsp;format=&quot;STRING&quot;]</span><span class="syntax--punctuation syntax--definition syntax--comment syntax--js"><span>*/</span></span></span><span class="syntax--meta syntax--brace syntax--round syntax--js"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--js"><span>;</span></span></span></div></pre></li><li><p>As a <code>boolean</code> sign that means that <code>this.html</code>/<code>this.css</code> files should be loaded by RockJS from the <code>index.html</code>/<code>style.css</code> file that placed in the module directory. This way is less preffered, because requires to create an additional HTTP requests that increase loading time.</p></li></ul><p><a name="this-node"></a> A <code>this.node</code> property allows to predefine any amount of DOM nodes from the module DOM that helps working with them for a long time. This property can be defined by different ways:</p><ul><li><p>As <code>object</code> that should provide properties with a property name as an internal reference name and property value as a reference CSS selector in the module DOM. Also, you can define the property value as boolean <code>true</code>, that means that internal reference name it the same as element className.</p><p><em>For example:</em></p><pre class="editor-colors lang-javascript"><div class="line"><span class="syntax--source syntax--js"><span class="syntax--variable syntax--language syntax--js"><span>this</span></span><span class="syntax--meta syntax--delimiter syntax--property syntax--period syntax--js"><span>.</span></span><span class="syntax--variable syntax--other syntax--property syntax--js"><span>node</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--js"><span>=</span></span><span>&nbsp;</span><span class="syntax--meta syntax--brace syntax--curly syntax--js"><span>{</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--js"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--js"><span>&quot;</span></span><span>userName</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--js"><span>&quot;</span></span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--js"><span>:</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--js"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--js"><span>&quot;</span></span><span>.user&nbsp;&gt;&nbsp;input.name</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--js"><span>&quot;</span></span></span><span class="syntax--meta syntax--delimiter syntax--object syntax--comma syntax--js"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--js"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--js"><span>&quot;</span></span><span>userForm</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--js"><span>&quot;</span></span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--js"><span>:</span></span><span>&nbsp;</span><span class="syntax--constant syntax--language syntax--boolean syntax--true syntax--js"><span>true</span></span><span>&nbsp;</span><span class="syntax--comment syntax--line syntax--double-slash syntax--js"><span class="syntax--punctuation syntax--definition syntax--comment syntax--js"><span>//</span></span><span>&nbsp;that&nbsp;means&nbsp;&quot;.userForm&quot;</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span class="syntax--meta syntax--brace syntax--curly syntax--js"><span>}</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--js"><span>;</span></span></span></div></pre></li><li><p>As a special-formatted string that has similar to <code>object</code> way format.</p><p><em>For example:</em></p><pre class="editor-colors lang-javascript"><div class="line"><span class="syntax--source syntax--js"><span class="syntax--variable syntax--language syntax--js"><span>this</span></span><span class="syntax--meta syntax--delimiter syntax--property syntax--period syntax--js"><span>.</span></span><span class="syntax--variable syntax--other syntax--property syntax--js"><span>node</span></span><span>&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--js"><span>=</span></span><span>&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--js"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--js"><span>&quot;</span></span><span>userName:&nbsp;.user&nbsp;&gt;&nbsp;input.name;&nbsp;userForm</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--js"><span>&quot;</span></span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--js"><span>;</span></span></span></div></pre></li></ul><p>All predefined nodes will be available in the <code>$O.node</code> object at once when the module will be created.</p><p>It will be something like that:</p><pre class="editor-colors lang-javascript"><div class="line"><span class="syntax--source syntax--js"><span class="syntax--comment syntax--line syntax--double-slash syntax--js"><span class="syntax--punctuation syntax--definition syntax--comment syntax--js"><span>//</span></span><span>&nbsp;$O.node</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span class="syntax--meta syntax--brace syntax--curly syntax--js"><span>{</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--js"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--js"><span>&quot;</span></span><span>userName</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--js"><span>&quot;</span></span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--js"><span>:</span></span><span>&nbsp;</span><span class="syntax--meta syntax--brace syntax--square syntax--js"><span>[</span></span><span class="syntax--constant syntax--other syntax--js"><span>DOM</span></span><span>&nbsp;node</span><span class="syntax--meta syntax--brace syntax--square syntax--js"><span>]</span></span><span class="syntax--meta syntax--delimiter syntax--object syntax--comma syntax--js"><span>,</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;&nbsp;</span><span class="syntax--string syntax--quoted syntax--double syntax--js"><span class="syntax--punctuation syntax--definition syntax--string syntax--begin syntax--js"><span>&quot;</span></span><span>userForm</span><span class="syntax--punctuation syntax--definition syntax--string syntax--end syntax--js"><span>&quot;</span></span></span><span class="syntax--keyword syntax--operator syntax--assignment syntax--js"><span>:</span></span><span>&nbsp;</span><span class="syntax--meta syntax--brace syntax--square syntax--js"><span>[</span></span><span class="syntax--constant syntax--other syntax--js"><span>DOM</span></span><span>&nbsp;node</span><span class="syntax--meta syntax--brace syntax--square syntax--js"><span>]</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span class="syntax--meta syntax--brace syntax--curly syntax--js"><span>}</span></span></span></div></pre><p>To handling the global environment changes a component can define the following methods:</p><ul><li><p><code>this.onRequest (options)</code> - This method can be used to communicate between components even when component instance was not created yet;</p></li><li><p><code>this.onCreate (options)</code> - This method will be called once when component instance has been created and environment of component <code>$O</code> is completely ready;</p></li><li><p><code>this.onShow (options, page)</code> - This method will be called every time when component instance should be shown;</p></li><li><p><code>this.onHide (options, page)</code> - This method will be called every time when component instance should be hidden;</p></li></ul><blockquote><p>Note that these methods can be called also by an another components that includes the component inside.</p></blockquote><p>Also, component can handle and emit both internal and/or external events. To create an internal event environment you can use <code>$R.eventFactory (this)</code> class, that extends your <code>this</code> object with internal event system.</p><p><em>For example:</em></p><pre class="editor-colors lang-javascript"><div class="line"><span class="syntax--source syntax--js"><span class="syntax--meta syntax--function syntax--js"><span class="syntax--storage syntax--type syntax--function syntax--js"><span>function</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--function syntax--js"><span>module_loremIpsum</span></span><span>&nbsp;</span><span class="syntax--meta syntax--parameters syntax--js"><span class="syntax--punctuation syntax--definition syntax--parameters syntax--begin syntax--bracket syntax--round syntax--js"><span>(</span></span><span class="syntax--constant syntax--other syntax--js"><span>$R</span></span><span class="syntax--meta syntax--delimiter syntax--object syntax--comma syntax--js"><span>,</span></span><span>&nbsp;</span><span class="syntax--constant syntax--other syntax--js"><span>$O</span></span><span class="syntax--punctuation syntax--definition syntax--parameters syntax--end syntax--bracket syntax--round syntax--js"><span>)</span></span></span></span><span>&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--function syntax--body syntax--begin syntax--bracket syntax--curly syntax--js"><span>{</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;&nbsp;</span><span class="syntax--storage syntax--type syntax--var syntax--js"><span>var</span></span><span>&nbsp;that&nbsp;</span><span class="syntax--keyword syntax--operator syntax--assignment syntax--js"><span>=</span></span><span>&nbsp;</span><span class="syntax--variable syntax--language syntax--js"><span>this</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--js"><span>;</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;&nbsp;</span><span class="syntax--meta syntax--function syntax--js"><span class="syntax--entity syntax--name syntax--function syntax--constructor syntax--js"><span>constructor</span></span><span class="syntax--meta syntax--parameters syntax--js"><span class="syntax--punctuation syntax--definition syntax--parameters syntax--begin syntax--bracket syntax--round syntax--js"><span>(</span></span><span class="syntax--punctuation syntax--definition syntax--parameters syntax--end syntax--bracket syntax--round syntax--js"><span>)</span></span></span></span><span>;</span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;&nbsp;function&nbsp;constructor&nbsp;()&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--function syntax--body syntax--begin syntax--bracket syntax--curly syntax--js"><span>{</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--meta syntax--class syntax--instance syntax--constructor syntax--js"><span class="syntax--keyword syntax--operator syntax--new syntax--js"><span>new</span></span><span>&nbsp;</span><span class="syntax--entity syntax--name syntax--type syntax--instance syntax--js"><span>$R</span><span class="syntax--meta syntax--delimiter syntax--property syntax--period syntax--js"><span>.</span></span><span>eventFactory</span></span></span><span class="syntax--meta syntax--brace syntax--round syntax--js"><span>(</span></span><span>that</span><span class="syntax--meta syntax--brace syntax--round syntax--js"><span>)</span></span><span class="syntax--punctuation syntax--terminator syntax--statement syntax--js"><span>;</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--comment syntax--line syntax--double-slash syntax--js"><span class="syntax--punctuation syntax--definition syntax--comment syntax--js"><span>//</span></span><span>&nbsp;After&nbsp;this&nbsp;call&nbsp;your&nbsp;module&nbsp;will&nbsp;be&nbsp;extended&nbsp;with&nbsp;the&nbsp;following&nbsp;methods:</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--comment syntax--line syntax--double-slash syntax--js"><span class="syntax--punctuation syntax--definition syntax--comment syntax--js"><span>//</span></span><span>&nbsp;this.on(type,&nbsp;listener);</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--comment syntax--line syntax--double-slash syntax--js"><span class="syntax--punctuation syntax--definition syntax--comment syntax--js"><span>//</span></span><span>&nbsp;this.off(type,&nbsp;listener);</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="syntax--comment syntax--line syntax--double-slash syntax--js"><span class="syntax--punctuation syntax--definition syntax--comment syntax--js"><span>//</span></span><span>&nbsp;this.emit(type,&nbsp;data,&nbsp;target,&nbsp;preventCallback,&nbsp;stopCallback,&nbsp;completeCallback);</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;&nbsp;</span><span class="syntax--punctuation syntax--definition syntax--function syntax--body syntax--end syntax--bracket syntax--curly syntax--js"><span>}</span></span></span></div><div class="line"><span class="syntax--source syntax--js"><span>&nbsp;</span></span></div><div class="line"><span class="syntax--source syntax--js"><span class="syntax--punctuation syntax--definition syntax--function syntax--body syntax--end syntax--bracket syntax--curly syntax--js"><span>}</span></span></span></div></pre><h3 id="/doc/7.1">$O object structure</h3><ul><li><p><code>DOM {node}</code> Sandboxed DOM node of component instance;</p></li><li><p><code>node {object}</code> The object of named DOM nodes (see <a href="#this-node">details</a>);</p></li><li><p><code>id {string|null}</code> An unique identifier of component instance (see <a href="#/doc/8">details</a>);</p></li><li><p><code>name {string}</code> The name of the component for which one was created instance (see <a href="#/doc/8">details</a>);</p></li><li><p><code>options {object}</code> An object of instance options;</p></li><li><p><code>template (id[, DOM]) {function}</code> This function allows to extract template body by <code>id</code> of template and as an optional <code>DOM</code> node where it placed. By default, initially it tries to get template from the component DOM and then from the current <code>document.body</code> node.</p><p>Template definition format: <code>&lt;script type=&quot;text/template&quot; id=&quot;{id}&quot;&gt; {template} &lt;/script&gt;</code></p></li><li><p><code>spin {spinner}</code> Own instance of spinner for the current instance of component;</p></li><li><p><code>stylesheet {style}</code> A DOM node of stylesheet for the current instance of component;</p></li><li><p><code>type {string}</code> A type of component (module/layout/etc.);</p></li><li><p><code>isReady {function}</code> This function allows to check is ready an instance of component or not at the moment;</p></li><li><p><code>isVisible {function}</code> This function allows to check is visible an instance of component or not at the moment;</p></li><li><p><code>extractNodes (dom, def) {function}</code> This function allows to create a reference object between module DOM nodes and them reference property names.</p><ul><li><p><code>dom {node}</code> The DOM node that contains nodes which are listed in <code>def</code></p></li><li><p><code>def {string|object}</code> Reference definition</p></li></ul></li></ul><h3 id="/doc/7.2">Compositions and naming features</h3><p>To embed or gum up anything such as markup blocks, stylesheets, base64 encoded content or something else in any file, can be used <code>include</code> tag. For more details <a href="#/doc/13">look here</a>.</p><p>From the view side, any module has a <code>&lt;div&gt;</code> wrapper that has specific-named classnames such as <code>module</code> and <code>module-{moduleName}</code> that linked to CSS via special <code>#this</code> selector. In other words, to link any part of the module markup with his styles, you donâ€™t need to start CSS selector from <code>module-loremIpsumDolorSitAmet...</code>. Instead of this you can just write <code>#this</code> that will be automatically replaced to valid classname.</p><p>Moreover, relative URLs supported from the <code>style.css</code> file (such as background-image, etc.), despite the fact that behind the scenes, all components are loaded as content via AJAX.</p>